% case.m - 自定义案例文件

% 母线数据
% [bus_num type V_mag V_angle V_max V_min]
case_mpc.bus = [
    1 3 1.0 0 1 1;
    2 1 1.0 0 1.05 0.9;
    3 1 1.0 0 1.05 0.9;
    4 1 1.0 0 1.05 0.9;
    5 1 1.0 0 1.05 0.9;
    6 1 1.0 0 1.05 0.9;
    7 1 1.0 0 1.05 0.9;
    8 1 1.0 0 1.05 0.9;
    9 1 1.0 0 1.05 0.9;
    10 1 1.0 0 1.05 0.9;
    11 1 1.0 0 1.05 0.9;
    12 1 1.0 0 1.05 0.9;
    13 1 1.0 0 1.05 0.9;
    14 1 1.0 0 1.05 0.9;
    15 1 1.0 0 1.05 0.9;
    16 1 1.0 0 1.05 0.9;
    17 1 1.0 0 1.05 0.9;
    18 1 1.0 0 1.05 0.9;
    19 1 1.0 0 1.05 0.9;
    20 1 1.0 0 1.05 0.9;
    21 1 1.0 0 1.05 0.9;
    22 1 1.0 0 1.05 0.9;
    23 1 1.0 0 1.05 0.9;
    24 1 1.0 0 1.05 0.9;
    25 1 1.0 0 1.05 0.9;
    26 1 1.0 0 1.05 0.9;
    27 1 1.0 0 1.05 0.9;
    28 1 1.0 0 1.05 0.9;
    29 1 1.0 0 1.05 0.9;
    30 1 1.0 0 1.05 0.9;
    31 1 1.0 0 1.05 0.9;
    32 1 1.0 0 1.05 0.9;
    33 1 1.0 0 1.05 0.9;
];

% 支路数据
% [from_bus to_bus r x b I_max]
case_mpc.branch = [
    1 2 0.0922 0.0470 0 10;
    2 3 0.4930 0.2511 0 10;
    3 4 0.3660 0.1864 0 10;
    4 5 0.3811 0.1941 0 10;
    5 6 0.8190 0.7070 0 10;
    6 7 0.1872 0.6188 0 10;
    7 8 0.7114 0.2351 0 10;
    8 9 1.0300 0.7400 0 10;
    9 10 1.0440 0.7400 0 10;
    10 11 0.1966 0.0650 0 10;
    11 12 0.3744 0.1238 0 10;
    12 13 1.4680 1.1550 0 10;
    13 14 0.5416 0.7129 0 10;
    14 15 0.5910 0.5260 0 10;
    15 16 0.7463 0.5450 0 10;
    16 17 1.2890 1.7210 0 10;
    17 18 0.7320 0.5740 0 10;
    2 19 0.1640 0.1565 0 10;
    19 20 1.5042 1.3554 0 10;
    20 21 0.4095 0.4784 0 10;
    21 22 0.7089 0.9373 0 10;
    3 23 0.4512 0.3083 0 10;
    23 24 0.8980 0.7091 0 10;
    24 25 0.8960 0.7011 0 10;
    6 26 0.2030 0.1034 0 10;
    26 27 0.2842 0.1447 0 10;
    27 28 1.0590 0.9337 0 10;
    28 29 0.8042 0.7006 0 10;
    29 30 0.5075 0.2585 0 10;
    30 31 0.9744 0.9630 0 10;
    31 32 0.3105 0.3619 0 10;
    32 33 0.3410 0.5302 0 10;
];

% 发电机数据
% [conn_bus P_max P_min Q_max Q_min S SIC loss a tu CF eff]
% case_mpc.gen = [
%     4 1 0 1 0 1.3 1 0.1 20 8000 200 0.9;
% ];

% 光伏发电数据
% [conn_bus P_max P_min n S k a b]
% case_mpc.pv = [
%     4 0.09 0 0.9 0.1 0.0872 10800 0.05;
%     19 0.09 0 0.9 0.1 0.0872 10800 0.05;
%     23 0.09 0 0.9 0.1 0.0872 10800 0.05;
% ];

% 风力发电数据
% [conn_bus P_max P_min n S k a b]
% case_mpc.wind = [
%     8 0.09 0 0.9 0.1 0.0872 11520 0.32;
%     14 0.09 0 0.9 0.1 0.0872 11520 0.32;
%     29 0.09 0 0.9 0.1 0.0872 11520 0.32;
% ];

% 储能电站数据
% [conn_bus P_max P_min n S a b c]
% case_mpc.ess = [
%     6 0.2 0 0.9 0.23 0 0 0;
% ];

% 母线功率需求时段数据
case_mpc.pd_time = cat(3, ...
    repmat([0 100 90 120 60 60 200 200 60 60 45 60 60 120 60 60 60 90 90 90 90 90 90 420 420 60 60 60 120 200 150 210 60]', 1, 24), ... % 场景1
    repmat([0 100 90 120 60 60 200 200 60 60 45 60 60 120 60 60 60 90 90 90 90 90 90 420 420 60 60 60 120 200 150 210 60]', 1, 24), ... % 场景2
    repmat([0 100 90 120 60 60 200 200 60 60 45 60 60 120 60 60 60 90 90 90 90 90 90 420 420 60 60 60 120 200 150 210 60]', 1, 24) ... % 场景3
);

case_mpc.qd_time = cat(3, ...
    repmat([0 60 40 80 30 20 100 100 20 20 30 35 35 80 10 20 20 40 40 40 40 40 50 200 200 25 25 20 70 600 70 100 40]', 1, 24), ... % 场景1
    repmat([0 60 40 80 30 20 100 100 20 20 30 35 35 80 10 20 20 40 40 40 40 40 50 200 200 25 25 20 70 600 70 100 40]', 1, 24), ... % 场景2
    repmat([0 60 40 80 30 20 100 100 20 20 30 35 35 80 10 20 20 40 40 40 40 40 50 200 200 25 25 20 70 600 70 100 40]', 1, 24) ... % 场景3
);

% 电价数据
case_mpc.price = [
    0.3344 0.3344 0.3344 0.3344 0.3344 0.3344 0.3344 0.5636 0.64 0.64 0.64 0.64 0.64 0.64 0.937975 1.0373 1.0373 1.0373 1.0373 1.0373 1.0373 1.0373 0.64 0.3344;
]';
% case_mpc.price = [0.663];

% 光伏日出力时段数据
case_mpc.pv_time = [
    [0 0 0 0 0 0 0 0 0.0469 0.0875 0.1700 0.7477 0.9890 1.0000 0.9023 0.6751 0.3489 0.0241 0 0 0 0 0 0]; ... % 场景1
    [0 0 0 0 0 0 0 0 0.0469 0.0875 0.1700 0.7477 0.9890 1.0000 0.9023 0.6751 0.3489 0.0241 0 0 0 0 0 0]; ... % 场景2
    [0 0 0 0 0 0 0 0 0.0469 0.0875 0.1700 0.7477 0.9890 1.0000 0.9023 0.6751 0.3489 0.0241 0 0 0 0 0 0]; ... % 场景3
];

% 风力日出力时段数据
case_mpc.wind_time = [
    [1.0000 0.8289 0.3338 0.3252 0.2411 0 0.4032 0.0886 0 0 0 0 0.2879 0.7593 0.7593 0.7593 0.7593 0.6979 0.6746 0.7593 0.7593 0.7593 0.3314 0.2853]; ... % 场景1
    [1.0000 0.8289 0.3338 0.3252 0.2411 0 0.4032 0.0886 0 0 0 0 0.2879 0.7593 0.7593 0.7593 0.7593 0.6979 0.6746 0.7593 0.7593 0.7593 0.3314 0.2853]; ... % 场景2
    [1.0000 0.8289 0.3338 0.3252 0.2411 0 0.4032 0.0886 0 0 0 0 0.2879 0.7593 0.7593 0.7593 0.7593 0.6979 0.6746 0.7593 0.7593 0.7593 0.3314 0.2853];  ... % 场景3
];