# 潮流计算优化程序

[项目地址](https://github.com/EternalLightning/PowerFlowOptimization) 
本项目是一个潮流优化计算程序，旨在打造一个相对通用的、开箱即用的程序，兼容新能源处理，方便科研计算。

## 数据格式定义

### 母线数据格式 (case_mpc.bus)
所有参数使用标幺制。

| 列号 | 数据类型 | 变量名 | 描述                   |
|------|----------|--------|------------------------|
| 1    | 整数     | bus_num | 母线编号               |
| 2    | 整数     | type   | 母线类型 (1=PQ, 2=PV, 3=平衡节点) |
| 3    | 实数     | V_mag     | 电压幅值 (p.u.)        |
| 4    | 实数     | V_angle  | 电压相角 (度)          |
| 5    | 实数     | V_max   | 最小电压限值 (p.u.)    |
| 6    | 实数     | V_min   | 最大电压限值 (p.u.)    |

对于第一列，我们希望 bus_num 值与行号严格对应。
对于不同的母线类型，程序只会选取所需的数据，因此您可以把无用数据置零（如 PQ 节点只选取 5、6 列）。

### 支路数据格式 (case_mpc.branch)
所有参数使用标幺制。

| 列号 | 数据类型 | 变量名 | 描述                   |
|------|----------|--------|------------------------|
| 1    | 整数     | from_bus | 起始母线编号           |
| 2    | 整数     | to_bux   | 终止母线编号           |
| 3    | 实数     | r      | 支路电阻 (p.u.)      |
| 4    | 实数     | x      | 支路电抗 (p.u.)      |
| 5    | 实数     | b      | 支路导纳 (p.u.)  |
| 6    | 实数     | I_max  | 最大电流限值 (p.u.) |

### 发电机数据格式 (case_mpc.gen)
所有参数使用标幺制。

| 列号 | 数据类型 | 变量名 | 描述                   |
|------|----------|--------|------------------------|
| 1    | 整数     | conn_bus | 相连母线编号               |
| 2    | 实数     | P_max   | 最大有功出力 Pmax (p.u.) |
| 3    | 实数     | P_min   | 最小有功出力 Pmin (p.u.) |
| 4    | 实数     | Q_max   | 最大无功出力 Qmax (p.u.) |
| 5    | 实数     | Q_min   | 最小无功出力 Qmin (p.u.) |
| 6    | 实数     | S      | 额定容量 (p.u.)        |
| 7    | 实数     | SIC | 相对于电站净功率折算的动态比投资费用       |
| 8    | 实数     | loss   | 发电机终端到售电结算点之间的线损率 |
| 9    | 实数     | a      | 电站的经济使用寿命  |
| 10   | 实数     | tu     | 发电设备的年运行利用小时数         |
| 11   | 实数     | CF     | 燃料费用     |
| 12   | 实数     | eff     | 发电效率     |

### 光伏发电数据格式 (case_mpc.pv)
所有参数使用标幺制。

| 列号 | 数据类型 | 变量名 | 描述                   |
|------|----------|--------|------------------------|
| 1    | 整数     | conn_bus | 相连母线编号               |
| 2    | 实数     | P_max   | 最大有功出力 (p.u.)    |
| 3    | 实数     | P_min   | 最小有功出力 (p.u.)    |
| 4    | 实数     | pf_s   | 功率因数（默认滞后）         |
| 5    | 实数     | S      | 最大可配置容量               |
| 6    | 实数     | k | 折算到每日的成本系数   |
| 7    | 实数     | a | 单位容量投资成本       |
| 8    | 实数     | b | 每度电的发电成本       |

光伏投资成本
$$C_{pv}^{inv}=\frac{k \cdot aS×10^3}{365}$$
光伏运行成本
$$C_{pv}^{run}=bP_{pv}\cdot t×10^3$$

### 风电数据格式 (case_mpc.wind)
所有参数使用标幺制。

| 列号 | 数据类型 | 变量名 | 描述                   |
|------|----------|--------|------------------------|
| 1    | 整数     | conn_bus | 相连母线编号  |
| 2    | 实数     | P_max  | 最大有功出力 (p.u.)    |
| 3    | 实数     | P_min  | 最小有功出力 (p.u.)    |
| 4    | 实数     | pf_w   | 功率因数 （默认滞后）  |
| 5    | 实数     | S    | 最大可配置容量               |
| 6    | 实数     | k | 折算到每日的成本系数   |
| 7    | 实数     | a | 单位容量投资成本       |
| 8    | 实数     | b | 每度电的发电成本       |

风电投资成本
$$C_{wind}^{inv}=\frac{k \cdot aS×10^3}{365}$$
风电运行成本
$$C_{wind}^{run}=bP_{wind}\cdot t×10^3$$

### 储能矩阵格式 (case_mpc.storage)
所有参数使用标幺制。

| 列号 | 数据类型 | 变量名 | 描述                   |
|------|----------|--------|------------------------|
| 1    | 整数     | conn_bus | 相连母线编号               |
| 2    | 实数     | Pmax_out | 最大输出有功出力 (p.u.) |
| 3    | 实数     | Pmax_in | 最大输入有功出力 (P_min < 0) (p.u.) |
| 4    | 实数     | pf_st     | 功率因数（默认滞后）     |
| 5    | 实数     | E | 最大可配置容量 (MWh)     |
| 6    | 实数     | a | 单位容量投资成本       |
| 7    | 实数     | b | 每千瓦时成本系数       |
| 8    | 实数     | c | 运维成本               |

### 电价矩阵 (case_mpc.price)
每度电的价格，一个长度为 conf.time 的列向量，记录每个时段的电价。

### 有功负荷矩阵
所有参数使用标幺制。
一个 $n_b \times conf.time$ 的矩阵，为每个母线每个时段的有功负荷需求。

### 无功负荷矩阵
所有参数使用标幺制。
一个 $n_b \times conf.time$ 的矩阵，为每个母线每个时段的无功负荷需求。

## 使用说明
使用本程序，您需要在 config.m 中指定案例文件 (conf.network.case_file)。其他设置在 config.m 中已有明确的注释，请自行设置。
案例文件中，需要定义一个结构体 case_mpc，至少包含上述矩阵，否则无法正常工作。